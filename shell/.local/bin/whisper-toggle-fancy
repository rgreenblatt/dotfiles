#!/usr/bin/env python3
"""Toggle whisper recording on/off, using fancy-whisper-stop for transcription.

Usage:
  whisper-toggle-fancy              # Type result with xdotool
  whisper-toggle-fancy --clipboard  # Copy result to clipboard
"""

import subprocess
import os
import sys

PID_FILE = "/tmp/whisper-recording.pid"

def is_recording():
    if not os.path.exists(PID_FILE):
        return False
    try:
        with open(PID_FILE) as f:
            pid = int(f.read().strip())
        os.kill(pid, 0)
        return True
    except (ProcessLookupError, ValueError):
        return False

if is_recording():
    # Pass through any arguments (like --clipboard)
    subprocess.run(["fancy-whisper-stop"] + sys.argv[1:])
else:
    subprocess.run(["whisper-record-start"])
    subprocess.run(["notify-send", "-u", "low", "-t", "1000", "Whisper", "Recording..."])
